{"version":3,"sources":["webpack:///./src/App.vue?49ce","webpack:///./src/App.vue","webpack:///src/App.vue","webpack:///src/components/imgUpload.vue","webpack:///./src/components/imgUpload.vue?1a21","webpack:///./src/components/imgUpload.vue","webpack:///src/components/index.vue","webpack:///./src/components/index.vue?65c7","webpack:///./src/components/index.vue","webpack:///./src/router/index.js","webpack:///./src/main.js"],"names":["selectortype_template_index_0_src_App","render","_h","this","$createElement","_c","_self","attrs","id","staticRenderFns","src_App","__webpack_require__","normalizeComponent","name","ssrContext","imgUpload","props","src","type","String","required","canEdit","Boolean","default","imgData","Object","multiple","change","maxlength","Number","clear","data","files","isFirstLoad","uploading","percent","newUrl","[object Object]","initFiles","methods","JSON","stringify","key","tempObj","push","$refs","file","click","index","console","log","length","warn","formData","FormData","blob","dataURItoBlob","size","append","xhr","XMLHttpRequest","upload","addEventListener","uploadProgress","open","send","onload","status","imgObj","Date","getTime","parse","response","Data","assign","$emit","list","splice","document","getElementsByClassName","style","display","i","item","compress","value","evt","component","lengthComputable","percentComplete","Math","round","loaded","total","vm","reader","FileReader","e","image","Image","target","result","originWidth","naturalWidth","originHeight","naturalHeight","targetWidth","targetHeight","maxWidth","canvas","createElement","context","getContext","orient","width","height","clearRect","EXIF","getData","getTag","save","translate","rotate","PI","drawImage","restore","toDataURL","$set","submit","readAsDataURL","dataurl","arr","split","mime","match","bstr","atob","n","u8arr","Uint8Array","charCodeAt","Blob","watch","clearFiles","components_imgUpload","_vm","staticClass","_v","_s","_l","alt","ondragstart","directives","rawName","expression","on","$event","remove","add","_m","_e","ref","accept","fileChanged","src_components_imgUpload","imgUpload_normalizeComponent","components","imgSrc","imgMax","clearImgData","upDateImg","selectortype_template_index_0_src_components","uploadImg","src_components","components_normalizeComponent","vue_esm","use","vue_router_esm","router","routes","path","config","productionTip","prototype","exif_default","a","el","template","App"],"mappings":"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","file":"static/js/app.0af8880266d897a0844c.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('router-view')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.2@vue-loader/lib/template-compiler?{\"id\":\"data-v-eca884e6\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.2@vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/_vue-loader@13.7.2@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-eca884e6\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n}\nvar normalizeComponent = require(\"!../node_modules/_vue-loader@13.7.2@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=script&index=0!./App.vue\"\nimport __vue_script__ from \"!!babel-loader!../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport __vue_template__ from \"!!../node_modules/_vue-loader@13.7.2@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-eca884e6\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = null\n// module chunks = ","<template>\n  <div id=\"app\">\n    <!-- <img src=\"./assets/logo.png\"> -->\n    <router-view/>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'app'\n}\n</script>\n\n<style>\n#app {\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n  margin-top: 60px;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/App.vue","<template>\n\t<div class=\"vue-uploader\">\n\t\t<!-- title -->\n\t\t<h3 class=\"file-tips\">\n\t\t\t还可上传{{maxlength - files.length}}张图片\n\t\t</h3>\n\t\t<div class=\"file-list\">\n\t\t\t<!-- img list -->\n\t\t\t<section v-for=\"(file, index) of files\" class=\"file-item draggable-item\" :key=\"file.src\">\n\t\t\t\t<img :src=\"file.src\" alt=\"\" ondragstart=\"return false;\">\n\t\t\t\t<span v-show=\"canEdit\" class=\"file-remove\" @click=\"remove(file, index)\">+</span>\n\t\t\t</section>\n\t\t\t<!-- add -->\n\t\t\t<section v-show=\"files.length < maxlength && canEdit\" class=\"file-item add-box\">\n\t\t\t\t<div @click=\"add\">\n\t\t\t\t\t<div class=\"add\">\n\t\t\t\t\t\t<span>+</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div> \n\t\t\t</section> \n\t\t</div> \n\t\t<!-- progress bar -->\n\t\t<section>\n\t\t\t<div class=\"imgProgress-bar\">\n\t\t\t\t<section v-if=\"uploading\" :style=\"{width:(percent * 100) + '%'}\">{{(percent * 100) + '%'}}</section>\n\t\t\t</div>\n\t\t</section>\n\t\t<!-- file -->\n\t\t<input type=\"file\" accept=\"image/*\" @change=\"fileChanged\" ref=\"file\" :multiple=\"multiple\"> \n\t</div>\n</template>\n<script>  \n\texport default {\n\t\tprops : {\n\t\t\tsrc : {//图片上传地址\n\t\t\t\ttype : String,\n\t\t\t\trequired : true\n\t\t\t},\n\t\t\tcanEdit : {//是否可编辑\n\t\t\t\ttype : Boolean,\n\t\t\t\tdefault : () =>{\n\t\t\t\t\treturn true\n\t\t\t\t} \n\t\t\t},\n\t\t\timgData : {//初始化img数据（编辑/查看时的数据源）\n\t\t\t\ttype : Object,\n\t\t\t\trequired : false,\n\t\t\t\tdefault : ()=>{\n\t\t\t\t\treturn {}\n\t\t\t\t}\n\t\t\t},\n\t\t\tmultiple : {//图片是否可多选\n\t\t\t\ttype : Boolean,\n\t\t\t\tdefault : ()=>{\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t},\n\t\t\tchange : {//修改数据源对象的值不能让数据源发生改变时使用（页面无刷新加载）\n\t\t\t\ttype : Boolean,\n\t\t\t\trequired : false\n\t\t\t},\n\t\t\tmaxlength : {//最多可上传多少张\n\t\t\t\ttype : Number,\n\t\t\t\tdefault : ()=>{\n\t\t\t\t\treturn 6\n\t\t\t\t}\n\t\t\t},\n\t\t\tclear : {//是否需要清除已上传的所有图片\n\t\t\t\ttype : Boolean,\n\t\t\t\trequired : false,\n\t\t\t\tdefault : ()=>{\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tfiles : [],//图片数据\n\t\t\t\tisFirstLoad : true, //是否是第一次加载\n\t\t\t\tuploading : false,// 上传中显示进度条\n\t\t\t\tpercent : 0,//进度条百分比\n\t\t\t\tnewUrl : '',//canvas压缩后图片地址\n\t\t\t}\n\t\t}, \n\t\tmounted (){\n\t\t\tthis.initFiles();  \n\t\t},\n\t\tmethods : {\n\t\t\t// 清除所有图片（首次加载时使用）\n\t\t\tclearFiles (){\n\t\t\t\tif (this.clear) {\n\t\t\t\t\tthis.files = [];\n\t\t\t\t}\n\t\t\t},\n\t\t\t// 初始化数据\n\t\t\tinitFiles (){ \n\t\t\t\tif (JSON.stringify(this.imgData) !== '{}') {\n\t\t\t\t\tfor (let key in this.imgData) {\n\t\t\t\t\t\tvar tempObj = {};\n\t\t\t\t\t\ttempObj['name'] = key;\n\t\t\t\t\t\ttempObj['src'] = process.env.NODE_ENV === 'production' ? this.imgData[key] + '?x-oss-process=image/resize,w_200,h_300/quality,q_100' : 'http://' + this.imgData[key] + '?x-oss-process=image/resize,w_200,h_300/quality,q_100';\n\t\t\t\t\t\tthis.files.push(tempObj);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.isFirstLoad = false;\n\t\t\t},\n\t\t\tadd() {\n\t\t\t\tthis.$refs.file.click()\n\t\t\t},\n\t\t\t// 上传图片\n\t\t\tsubmit(file, index) { \n\t\t\t\tconsole.log('图片上传中');\n\t\t\t\tif (this.files.length === 0) {\n\t\t\t\t\tconsole.warn('no file!');\n\t\t\t\t\treturn\n\t\t\t\t} \n\t\t\t\tconst formData = new FormData()\n\t\t\t\tvar blob = this.dataURItoBlob(this.newUrl);   \n\t\t\t\tconsole.log('压缩后的图片大小》》》', blob.size);\n\t\t\t\tformData.append(file.name, blob, 'image.png')  \n\t\t\t\tconst xhr = new XMLHttpRequest()\n\t\t\t\txhr.upload.addEventListener('progress', this.uploadProgress, false)\n\t\t\t\txhr.open('POST', this.src, true)\n\t\t\t\tthis.uploading = true\n\t\t\t\txhr.send(formData)\n\t\t\t\txhr.onload = () => {\n\t\t\t\t\tthis.uploading = false\n\t\t\t\t\tif (xhr.status === 200 || xhr.status === 304) {\n\t\t\t\t\tlet imgObj = {};\n\t\t\t\t\tlet key = new Date().getTime() + index;\n\t\t\t\t\timgObj[key] = JSON.parse(xhr.response).Data;\n\t\t\t\t\tfile.name = key;\n\t\t\t\t\tthis.imgData = Object.assign(this.imgData, imgObj);\n\t\t\t\t\tthis.$emit('uploadImg', this.imgData);\n\t\t\t\t\tconsole.log('图片上传成功！');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.log(`error：error code ${xhr.status}`)\n\t\t\t\t\t}\n\t\t\t\t}   \t\n\t\t\t}, \n\t\t\t// 移除图片\n\t\t\tremove(list, index) {\n\t\t\t\tthis.files.splice(index, 1);\n\t\t\t\tdelete this.imgData[list.name];\n\t\t\t\tthis.$emit('uploadImg', this.imgData);\n\t\t\t\tif (document.getElementsByClassName('v-modal').length) {\n\t\t\t\t\tdocument.getElementsByClassName('v-modal')[0].style.display = 'none'\n\t\t\t\t}\n\t\t\t},\n\t\t\t/*\n\t\t\tchange触发图片上传函数\n\t\t\t上传之前线判断图片大小是否符合最大尺寸\n\t\t\t如果大于最大尺寸则剪切图片\n\t\t\t每次选中一张图片都会上传一次\n\t\t\t */\n\t\t\tasync fileChanged() {\n\t\t\t\tlet list = this.$refs.file.files\n\t\t\t\tif(this.files.length + list.length < 7){\n\t\t\t\t\tfor (let i = 0; i < list.length; i++) {  \n\t\t\t\t\t\tconst item = {\n\t\t\t\t\t\t\tname : list[i].name,\n\t\t\t\t\t\t\tsize : list[i].size,\n\t\t\t\t\t\t\tfile : list[i]\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconsole.log('压缩前大小》》》', list[i].size);\n\t\t\t\t\t\tawait this.compress(list[i], item, i);\n\t\t\t\t\t\tthis.files.push(item); \n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tconsole.log('最多选择六张图片');\n\t\t\t\t}\n\t\t\t\tthis.$refs.file.value = '' \n\t\t\t},  \n\t\t\t// 进度条\n\t\t\t uploadProgress(evt) {\n\t\t\t\tconst component = this\n\t\t\t\tif (evt.lengthComputable) {\n\t\t\t\t    const percentComplete = Math.round((evt.loaded * 100) / evt.total)\n\t\t\t\t    component.percent = percentComplete / 100\n\t\t\t\t} else {\n\t\t\t\t    console.warn('upload progress unable to compute')\n\t\t\t\t}\n\t\t\t}, \n\t\t\t/*  \n\t\t\t压缩图片\n\t\t\tfilereader 对象允许Web应用程序异步读取存储在用户计算机上的文件\n\t\t\tImage()函数将会创建一个新的HTMLImageElement实例。它的功能等价于 document.createElement('img')\n\t\t\tnew Image用于获取上传图片（绘制canvas时会用到），并获取其大小用于设置最大尺寸（压缩）\n\t\t\t注意： 需要设置src之后才能触发onload中的函数\n\t\t\t*/\n\t\t\tcompress (file, item, i){\n\t\t\t\tconst vm = this;\n\t\t\t\tvar reader = new FileReader();\n\t\t\t\treader.onload = function(e) {\n\t\t\t\t\tvar image = new Image();\n\t\t\t\t\timage.src = e.target.result; \n\t\t\t\t\timage.onload = function() { \n\t\t\t\t\t\t// 图片原始尺寸\n\t\t\t\t\t\tvar originWidth = this.naturalWidth;\n\t\t\t\t\t\tvar originHeight = this.naturalHeight;\n\t\t\t\t\t\t// 最大尺寸限制，可通过设置宽高来实现图片压缩程度\n\t\t\t\t\t\tvar maxWidth = 300,\n\t\t\t\t\t\t\tmaxHeight = 300;\n\t\t\t\t\t\t// 目标尺寸\n\t\t\t\t\t\tvar targetWidth = originWidth,\n\t\t\t\t\t\t\ttargetHeight = originHeight;\n\t\t\t\t\t\t// 图片尺寸超过400x400的限制\n\t\t\t\t\t\tif (originWidth > maxWidth || originHeight > maxHeight) {\n\t\t\t\t\t\t\tif (originWidth / originHeight > maxWidth / maxHeight) {\n\t\t\t\t\t\t\t\t// 更宽，按照宽度限定尺寸\n\t\t\t\t\t\t\t\ttargetWidth = maxWidth;\n\t\t\t\t\t\t\t\ttargetHeight = Math.round(maxWidth * (originHeight / originWidth));\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttargetHeight = maxHeight;\n\t\t\t\t\t\t\t\ttargetWidth = Math.round(maxHeight * (originWidth / originHeight));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// 缩放图片需要的canvas\n\t\t\t\t\t\tvar canvas = document.createElement('canvas');\n\t\t\t\t\t\tvar context = canvas.getContext('2d');\n\n\t\t\t\t\t\t// canvas对图片进行缩放\n\t\t\t\t\t\tcanvas.width = targetWidth;\n\t\t\t\t\t\tcanvas.height = targetHeight;\n\t\t\t\t\t\t// 清除画布\n\t\t\t\t\t\tcontext.clearRect(0, 0, targetWidth, targetHeight);\n\t\t\t\t\t\t// 获取图片的拍摄方向（通过Exit.js 插件）\n\t\t\t\t\t\tlet orient;\n\t\t\t\t\t\tvm.EXIF.getData(image, () => { \n\t\t\t\t\t\t\torient = vm.EXIF.getTag(this, 'Orientation'); \n\t\t\t\t\t\t}); \n\t\t\t\t\t\t// 因为ios手机拍摄上传的图片会出现旋转的hack，这里需要特殊处理\n\t\t\t\t\t\t// 如果图片顺时针旋转了90度则调整下\n\t\t\t\t\t\tif (orient === 6) {\n\t\t\t\t\t\t\tcontext.save();\n\t\t\t\t\t\t\tcontext.translate(targetWidth / 2, targetHeight / 2);\n\t\t\t\t\t\t\tcontext.rotate(90 * Math.PI / 180);\n\t\t\t\t\t\t\t// 图片压缩\n\t\t\t\t\t\t\tcontext.drawImage(this, 0 - targetHeight / 2, 0 - targetWidth / 2, targetHeight, targetWidth);\n\t\t\t\t\t\t\tcontext.restore();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// 图片压缩\n\t\t\t\t\t\t\tcontext.drawImage(this, 0, 0, targetWidth, targetHeight);\n\t\t\t\t\t\t} \n\t\t\t\t\t\t//压缩后的图片base64 url\n\t\t\t\t\t\tvm.newUrl = canvas.toDataURL('image/jpeg');\n\t\t\t\t\t\tvm.$set(item, 'src', vm.newUrl);//生成预览地址\n\t\t\t\t\t\tvm.submit(item, i);\n\t\t\t\t\t\t\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t\treader.readAsDataURL(file); \n\t\t\t},\n\t\t\t// dataUrl转为blob对象，用于formdata数据提交\n\t\t\tdataURItoBlob (dataurl) {\n\t\t\t\tvar arr = dataurl.split(','), \n\t\t\t\t\tmime = arr[0].match(/:(.*?);/)[1],\n\t\t\t\t\tbstr = atob(arr[1]),//base-64编码过的字符串进行解码\n\t\t\t\t\tn = bstr.length, \n\t\t\t\t\tu8arr = new Uint8Array(n);//8 位无符号整数值的类型化数组\n\t\t\t\twhile(n--){\n\t\t\t\t\tu8arr[n] = bstr.charCodeAt(n);\n\t\t\t\t}\n\t\t\t\treturn new Blob([u8arr], {type : mime}); \n\t\t\t}, \n\t\t}, \n\t\twatch : { \n\t\t\tchange (){\n\t\t\t\tif (!this.isFirstLoad) {\n\t\t\t\t\tfor (let i = 0; i < this.files.length; i++) {\n\t\t\t\t\t\tif (this.files[i].name === 'selectImg') {\n\t\t\t\t\t\t\tthis.files.splice(i, 1);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t} \n\t\t\t\t\tthis.clearFiles();\n\t\t\t\t\tthis.initFiles(); \n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t}\n</script>\n<style>\n/* 图片预览 */\n.vue-uploader .file-list .file-item{ position: relative;float: left;width: 150px;height: 150px;margin: 0 20px 20px 0;text-align: center; }\n.vue-uploader .file-list .file-item img{ width: 100%;height: 100%;border: 1px solid #ececec; }\n.vue-uploader .file-list .file-item .file-remove{font-size: 20px;font-weight: bold;line-height: 20px; position: absolute;top: -10px;right: -10px;width: 20px;height: 20px;transform: rotate(45deg);text-align: center;color: #f00;border: 1px solid #f00;border-radius: 50%;background: transparent; }\n/* add */\n.vue-uploader .add{ font-size: 100px;line-height: 150px;float: left;width: 150px;height: 150px;cursor: pointer;text-align: center;color: #a9a9a9;border: 1px dashed #a9a9a9; }\n/* file */\n.vue-uploader > input[type='file']{ display: none; }\n/* progre */\n.vue-uploader .imgProgress-bar{ flex-grow: 1; }\n.vue-uploader .imgProgress-bar section{font-size: 12px; margin-top: 5px;transition: all .5s ease;text-align: center;color: #fff;border-radius: 3px;background: #00b4aa; }\n</style>\n\n\n// WEBPACK FOOTER //\n// src/components/imgUpload.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"vue-uploader\"},[_c('h3',{staticClass:\"file-tips\"},[_vm._v(\"\\n\\t\\t还可上传\"+_vm._s(_vm.maxlength - _vm.files.length)+\"张图片\\n\\t\")]),_vm._v(\" \"),_c('div',{staticClass:\"file-list\"},[_vm._l((_vm.files),function(file,index){return _c('section',{key:file.src,staticClass:\"file-item draggable-item\"},[_c('img',{attrs:{\"src\":file.src,\"alt\":\"\",\"ondragstart\":\"return false;\"}}),_vm._v(\" \"),_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.canEdit),expression:\"canEdit\"}],staticClass:\"file-remove\",on:{\"click\":function($event){_vm.remove(file, index)}}},[_vm._v(\"+\")])])}),_vm._v(\" \"),_c('section',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.files.length < _vm.maxlength && _vm.canEdit),expression:\"files.length < maxlength && canEdit\"}],staticClass:\"file-item add-box\"},[_c('div',{on:{\"click\":_vm.add}},[_vm._m(0)])])],2),_vm._v(\" \"),_c('section',[_c('div',{staticClass:\"imgProgress-bar\"},[(_vm.uploading)?_c('section',{style:({width:(_vm.percent * 100) + '%'})},[_vm._v(_vm._s((_vm.percent * 100) + '%'))]):_vm._e()])]),_vm._v(\" \"),_c('input',{ref:\"file\",attrs:{\"type\":\"file\",\"accept\":\"image/*\",\"multiple\":_vm.multiple},on:{\"change\":_vm.fileChanged}})])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"add\"},[_c('span',[_vm._v(\"+\")])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.2@vue-loader/lib/template-compiler?{\"id\":\"data-v-3e175b72\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.2@vue-loader/lib/selector.js?type=template&index=0!./src/components/imgUpload.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/_vue-loader@13.7.2@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-3e175b72\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=styles&index=0!./imgUpload.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/_vue-loader@13.7.2@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=script&index=0!./imgUpload.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=script&index=0!./imgUpload.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/_vue-loader@13.7.2@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-3e175b72\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=template&index=0!./imgUpload.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/imgUpload.vue\n// module id = null\n// module chunks = ","<template>\n  <div class=\"hello\">\n    <h1> This is an image upload demo </h1>\n    <h3>-By&nbsp;wrx</h3>\n    <!-- \n      class:组件样式\n      canedit: 组件是否可编辑\n      imgData：图片初始化数据(obj)，数据格式：{key: src, key2: src2}\n      uploadimg： 图片上传后的回调\n      src：图片上传地址\n      multiple：是否可以上传多张\n      maxlength：最多可以上传多少张（需要和multiple一起使用）\n      clear：清除所有图片（用于初始化清空图片，同时数据源imgdata需要清空）\n      change：触发组件的watch （用于初始化数据）\n     -->\n    <img-upload \n      class=\"yourBoxCss\"\n      :canEdit=\"canEdit\" \n      :imgData=\"imgData\"\n      @uploadImg='uploadImg' \n      :src=\"imgSrc\" \n      :multiple=\"multiple\"\n      :maxlength=\"imgMax\"\n      :clear=\"clearImgData\"\n      :change=\"upDateImg\">\n    </img-upload>\n  </div>\n</template>\n\n<script>\nimport imgUpload from '@/components/imgUpload' \nexport default {\n  name: 'HelloWorld',\n  data () {\n    return {\n      canEdit: true,\n      multiple: true,\n      imgSrc: '@/components/imgBox',\n      imgMax: 6,\n      clearImgData : true,\n      imgData: {},\n      upDateImg: false,\n    }\n  },\n  methods: { \n    uploadImg (){\n      // 上传图片触发此函数\n    }, \n  },\n  components : {\n    imgUpload\n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\nh1,\nh2{ font-weight: normal; }\n.yourBoxCss{ display: inline-block;width: auto;min-width: 80% ;height: auto;padding: 10px;border: 1px solid #f2f2f2; }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/index.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"hello\"},[_c('h1',[_vm._v(\" This is an image upload demo \")]),_vm._v(\" \"),_c('h3',[_vm._v(\"-By wrx\")]),_vm._v(\" \"),_c('img-upload',{staticClass:\"yourBoxCss\",attrs:{\"canEdit\":_vm.canEdit,\"imgData\":_vm.imgData,\"src\":_vm.imgSrc,\"multiple\":_vm.multiple,\"maxlength\":_vm.imgMax,\"clear\":_vm.clearImgData,\"change\":_vm.upDateImg},on:{\"uploadImg\":_vm.uploadImg}})],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.2@vue-loader/lib/template-compiler?{\"id\":\"data-v-226a4f1d\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.2@vue-loader/lib/selector.js?type=template&index=0!./src/components/index.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/_vue-loader@13.7.2@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-226a4f1d\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=styles&index=0!./index.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/_vue-loader@13.7.2@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=script&index=0!./index.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=script&index=0!./index.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/_vue-loader@13.7.2@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-226a4f1d\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=template&index=0!./index.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-226a4f1d\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/index.vue\n// module id = null\n// module chunks = ","import Vue from 'vue'\nimport Router from 'vue-router'\nimport index from '@/components/index'\n\nVue.use(Router)\n\nexport default new Router({\n  routes: [\n    {\n      path: '/',\n      name: 'index',\n      component: index\n    }\n  ]\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/router/index.js","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from 'vue'\nimport App from './App'\nimport router from './router' \nimport exif from 'exif-js' //用于获取拍摄图片的基本信息（例如：拍摄方向）\n\nVue.config.productionTip = false\nVue.prototype.EXIF = exif;\n/* eslint-disable no-new */\nnew Vue({\n  el: '#app',\n  router,\n  template: '<App/>',\n  components: { App }\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}